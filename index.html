<form id="bookingForm">
  <input type="text" name="name" placeholder="Full Name" required>
  <input type="tel" name="phone" placeholder="Phone Number" required>
  <input type="email" name="email" placeholder="Email Address">
  <input type="text" name="bike_type" placeholder="Motorcycle Make & Model" required>
  <select name="service" required>
    <option value="">Select Service</option>
    <option value="basic">Basic Clean - $50</option>
    <option value="premium">Premium Detail - $100</option>
    <option value="full">Full Service - $150</option>
  </select>
  <input type="date" name="date" required>
  <input type="time" name="time" required>
  <textarea name="notes" placeholder="Additional notes about your bike..."></textarea>
  
  <button type="submit">Book Now</button>
</form>

<script>
const scriptURL = "https://script.google.com/macros/s/AKfycbws-XZzwDQCkGsQzHKm259GF-TUNyVi24jtoaUZQRfnln4TEPmec9xn6DEnZfUUbOe-/exec";

document.getElementById("bookingForm").addEventListener("submit", async function(e) {
  e.preventDefault();
  
  const submitButton = e.target.querySelector('button[type="submit"]');
  const originalText = submitButton.textContent;
  
  // Show loading state
  submitButton.textContent = "Submitting...";
  submitButton.disabled = true;

  try {
    const formData = new FormData(this);
    const data = Object.fromEntries(formData.entries());

    console.log("Submitting data:", data);

    const response = await fetch(scriptURL, {
      method: "POST",
      headers: { 
        "Content-Type": "application/json" 
      },
      body: JSON.stringify(data)
    });

    const result = await response.json();
    console.log("Server response:", result);
    
    if (result.status === "success") {
      alert("✅ Booking submitted successfully!");
      this.reset();
    } else {
      throw new Error(result.message || "Server error occurred");
    }

  } catch (error) {
    console.error("Full error:", error);
    
    if (error.message.includes("Failed to fetch")) {
      alert("❌ Network error. Please check:\n• Your internet connection\n• That the script is properly deployed\n• Try refreshing the page");
    } else {
      alert("❌ Error: " + error.message);
    }
  } finally {
    // Reset button state
    submitButton.textContent = originalText;
    submitButton.disabled = false;
  }
});
</script>
